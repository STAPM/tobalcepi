---
title: "Risk of chronic conditions wholly-attributable to alcohol"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Alcohol wholly-attributable chronic risk}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
bibliography: disease-risks.bib
link-citations: yes
citation_package: natbib
biblio-style: vancouver
urlcolor: blue
editor_options: 
  chunk_output_type: console
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, include = FALSE, results = 'hide', warning = FALSE, eval = T}

suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(VGAM))

```

# Introduction
Here we describe the approach taken in STAPM to model the chronic health harms that are wholly-attributable to long-term high levels of alcohol consumption. The health harms that we consider in this category are: Alcoholic cardiomyopathy, Alcoholic gastritis, Alcoholic liver disease, Acute pancreatitis alcohol induced, Chronic pancreatitis alcohol induced, Alcohol induced pseudo-cushings syndrome, Alcoholic myopathy, Alcoholic polyneuropathy, Maternal care for suspected damage to foetus from alcohol, Degeneration, Mental and behavioural disorders due to use of alcohol [@Angus2018]. "Wholly-attributable" means that these conditions cannot occur without alcohol (i.e. all cases are due to alcohol consumption).    

# The SAPM method
We build on the method used to model the chronic health harms that are wholly-attributable to alcohol in the Sheffield Alcohol Policy Model (SAPM). The main issue is that there is minimal available evidence on the relationship between the level of long-term alcohol consumption and the risk of chronic harms that were wholly attributable to alcohol. Assumptions are therefore needed about the shape of the risk function that links alcohol consumption to the risk of wholly alcohol attributable chronic conditions (the approach taken is described on page 28 in the Purshouse et al. modelling report for NICE [-@purshouse2009nice]).    

When the UK healthy drinking guidelines were revised, the thresholds used were revised to 2 units/day for females and males (14 units/week). Figure 1 shows the shape of the risk function currently used in SAPM.         

```{r wa_chronic_risk_function, eval = T, echo = F, fig.align="left", warning = F, out.extra='', fig.pos = "h", fig.width = 5, fig.height = 3, fig.cap = "**Figure 1.** Illustrative linear absolute risk function for a wholly-attributable chronic harm. It is assumed that people are not at risk of harm unless they drink to levels above the UK health drinking guidelines of 2 units/day on average (14 units/week). Above these thresholds, it is assumed that risk increases linearly with the amount drunk."}

threshold_male <- 2
threshold_female <- 2

data <- data.table(units = seq(0, 40, length.out = 1e4), risk = seq(0, 40, length.out = 1e4))
data <- rbindlist(list(copy(data)[ , sex := "Male"], copy(data)[ , sex := "Female"]), use.names = T)

data[sex == "Male", risk := risk - threshold_male]
data[sex == "Female", risk := risk - threshold_female]

data[risk < 0, risk := 0]

ggplot(data) +
  geom_line(aes(x = units, y = risk, colour = sex)) + 
  theme_minimal() +
  xlab("Average units drunk per day") + ylab("Absolute risk") +
  scale_colour_manual(name = "Sex", values = c("#6600cc", "#00cc99"))

```

# Implementing in the STAPM code  
The SAPM method is implemented unchanged in the STAPM code, within the function `tobalcepi::RRalc()`.   

# References




